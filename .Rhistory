setwd("C:/Users/mathon/Desktop/linux/eDNA--benchmark_pipelines")
library(dplyr)
library(tidyr)
library(plyr)
library(stringr)
library(tidyverse)
library(purrr)
library(seqinr)
library(Biostrings)
library(reshape2)
library(ggplot2)
library(forcats)
library(Metrics)
library(plotrix)
library(cowplot)
library(gridExtra)
library(grid)
library(ggpubr)
time <- read.csv("C:/Users/mathon/Desktop/PhD/Projets/Comparaison_pipelines/time_programs.csv", sep = ";")
time_merging <- time %>%
filter(step=="merging")
plot_merging <- ggplot(time_merging, aes(x=reorder(program, time_grinder), y=time_grinder, label=time_grinder)) +
geom_bar(stat = "identity", width=0.4) +
geom_text(size = 4, position = position_nudge(y = +70)) +
xlab("") +
ylab("") +
theme(axis.text.x = element_text(size = 9)) +
theme(axis.text.y = element_text(size = 12)) +
theme(panel.background = element_rect(fill="white", colour="grey", size=0.5, linetype="solid"))+
coord_flip()
plot_merging
time_demul <- time %>%
filter(step=="demultiplex")
plot_demul <- ggplot(time_demul, aes(x=reorder(program, time_grinder), y=time_grinder, label=time_grinder)) +
geom_bar(stat = "identity", width=0.3) +
geom_text(size = 4, position = position_nudge(y = +30)) +
xlab("") +
ylab("") +
theme(axis.text.x = element_text(size = 9)) +
theme(axis.text.y = element_text(size = 12)) +
theme(panel.background = element_rect(fill="white", colour="grey", size=0.5, linetype="solid"))+
coord_flip()
time_derep <- time %>%
filter(step=="dereplication")
plot_derep <- ggplot(time_derep, aes(x=reorder(program, time_grinder), y=time_grinder, label=time_grinder)) +
geom_bar(stat = "identity", width=0.3) +
geom_text(size = 4, position = position_nudge(y = +10)) +
xlab("") +
ylab("") +
theme(axis.text.x = element_text(size = 9)) +
theme(axis.text.y = element_text(size = 12)) +
theme(panel.background = element_rect(fill="white", colour="grey", size=0.5, linetype="solid"))+
coord_flip()
time_filter <- time %>%
filter(step=="filtering")
plot_filter <- ggplot(time_filter, aes(x=reorder(program, time_grinder), y=time_grinder, label=time_grinder)) +
geom_bar(stat = "identity", width=0.4) +
geom_text(size = 4, position = position_nudge(y = +0.1)) +
xlab("") +
ylab("") +
theme(axis.text.x = element_text(size = 9)) +
theme(axis.text.y = element_text(size = 12)) +
theme(panel.background = element_rect(fill="white", colour="grey", size=0.5, linetype="solid"))+
coord_flip()
time_error <- time %>%
filter(step=="error_removal")
plot_error <- ggplot(time_error, aes(x=reorder(program, time_grinder), y=time_grinder, label=time_grinder)) +
geom_bar(stat = "identity", width=0.35) +
geom_text(size = 4, position = position_nudge(y = +1)) +
xlab("") +
ylab("") +
theme(axis.text.x = element_text(size = 9)) +
theme(axis.text.y = element_text(size = 12)) +
theme(panel.background = element_rect(fill="white", colour="grey", size=0.5, linetype="solid"))+
coord_flip()
time_assign <- time %>%
filter(step=="assignment")
plot_assign <- ggplot(time_assign, aes(x=reorder(program, time_grinder), y=time_grinder, label=time_grinder)) +
geom_bar(stat = "identity", width=0.35) +
geom_text(size = 4, position = position_nudge(y = +3)) +
xlab("") +
ylab("") +
theme(axis.text.x = element_text(size = 9)) +
theme(axis.text.y = element_text(size = 12)) +
theme(panel.background = element_rect(fill="white", colour="grey", size=0.5, linetype="solid"))+
coord_flip()
plot_time <- plot_grid(plot_merging, plot_demul, plot_derep, plot_filter, plot_error, plot_assign, ncol=1, labels = c("(a)", "(b)", "(c)", "(d)", "(e)", "(f)"), heights = c(1.4,1,1,1.3,1.1,1.1), font.label = list(size = 10))
plot_time <- ggarrange(plot_merging, plot_demul, plot_derep, plot_filter, plot_error, plot_assign, ncol=1, labels = c("(a)", "(b)", "(c)", "(d)", "(e)", "(f)"), heights = c(1.4,1,1,1.3,1.1,1.1), font.label = list(size = 10))
plot_time
plot_time <- ggarrange(plot_merging, plot_demul, plot_derep, plot_filter, plot_error, plot_assign, ncol=1, labels = c("Merging", "Demultiplexing", "Dereplication", "Filtering", "Error removal", "Taxonomic assignment"), label.x=1, label.y=1.5,heights = c(1.4,1,1,1.3,1.1,1.1), font.label = list(size = 10))
plot_time
plot_time <- ggarrange(plot_merging, plot_demul, plot_derep, plot_filter, plot_error, plot_assign, ncol=1, labels = c("Merging", "Demultiplexing", "Dereplication", "Filtering", "Error removal", "Taxonomic assignment"), label.x=0.1, label.y=1.5,heights = c(1.4,1,1,1.3,1.1,1.1), font.label = list(size = 10))
plot_time
plot_time <- ggarrange(plot_merging, plot_demul, plot_derep, plot_filter, plot_error, plot_assign, ncol=1, labels = c("Merging", "Demultiplexing", "Dereplication", "Filtering", "Error removal", "Taxonomic assignment"), label.x=0.02, label.y=1.02,heights = c(1.4,1,1,1.3,1.1,1.1), font.label = list(size = 10))
plot_time
plot_time <- ggarrange(plot_merging, plot_demul, plot_derep, plot_filter, plot_error, plot_assign, ncol=1, labels = c("Merging", "Demultiplexing", "Dereplication", "Filtering", "Error removal", "Taxonomic assignment"), label.x=0, label.y=1.02,heights = c(1.4,1,1,1.3,1.1,1.1), font.label = list(size = 10))
plot_time
plot_time <- ggarrange(plot_merging, plot_demul, plot_derep, plot_filter, plot_error, plot_assign, ncol=1, labels = c("Merging", "Demultiplexing", "Dereplication", "Filtering", "Error removal", "Taxonomic assignment"),heights = c(1.4,1,1,1.3,1.1,1.1), font.label = list(size = 10))
plot_time
plot_time <- ggarrange(plot_merging, plot_demul, plot_derep, plot_filter, plot_error, plot_assign, ncol=1, labels = c("Merging", "Demultiplexing", "Dereplication", "Filtering", "Error removal", "Taxonomic assignment"),heights = c(1.4,1,1,1.3,1.1,1.1), font.label = list(size = 10))
plot_time
plot_time <- ggarrange(plot_merging, plot_demul, plot_derep, plot_filter, plot_error, plot_assign, ncol=1, hjust=-0.5, vjust=1.1, labels = c("Merging", "Demultiplexing", "Dereplication", "Filtering", "Error removal", "Taxonomic assignment"),heights = c(1.4,1,1,1.3,1.1,1.1), font.label = list(size = 10))
plot_time
plot_assign <- ggplot(time_assign, aes(x=reorder(program, time_grinder), y=time_grinder, label=time_grinder)) +
geom_bar(stat = "identity", width=0.35) +
geom_text(size = 4, position = position_nudge(y = +3)) +
xlab("Time (min)") +
ylab("") +
theme(axis.text.x = element_text(size = 9)) +
theme(axis.text.y = element_text(size = 12)) +
theme(panel.background = element_rect(fill="white", colour="grey", size=0.5, linetype="solid"))+
coord_flip()
plot_time <- ggarrange(plot_merging, plot_demul, plot_derep, plot_filter, plot_error, plot_assign, ncol=1, hjust=-0.5, vjust=1.1, labels = c("Merging", "Demultiplexing", "Dereplication", "Filtering", "Error removal", "Taxonomic assignment"),heights = c(1.4,1,1,1.3,1.1,1.1), font.label = list(size = 10))
plot_time
plot_assign <- ggplot(time_assign, aes(x=reorder(program, time_grinder), y=time_grinder, label=time_grinder)) +
geom_bar(stat = "identity", width=0.35) +
geom_text(size = 4, position = position_nudge(y = +3)) +
xlab("") +
ylab("Time (min)") +
theme(axis.text.x = element_text(size = 9)) +
theme(axis.text.y = element_text(size = 12)) +
theme(panel.background = element_rect(fill="white", colour="grey", size=0.5, linetype="solid"))+
coord_flip()
plot_time <- ggarrange(plot_merging, plot_demul, plot_derep, plot_filter, plot_error, plot_assign, ncol=1, hjust=-0.5, vjust=1.1, labels = c("Merging", "Demultiplexing", "Dereplication", "Filtering", "Error removal", "Taxonomic assignment"),heights = c(1.4,1,1,1.3,1.1,1.1), font.label = list(size = 10))
plot_time
plot_assign <- ggplot(time_assign, aes(x=reorder(program, time_grinder), y=time_grinder, label=time_grinder)) +
geom_bar(stat = "identity", width=0.35) +
geom_text(size = 4, position = position_nudge(y = +3)) +
xlab("") +
ylab("Time (min)") +
ggtitle("Taxonomic assignment")
plot_time <- ggarrange(plot_merging, plot_demul, plot_derep, plot_filter, plot_error, plot_assign, ncol=1, hjust=-0.5, vjust=1.1, labels = c("Merging", "Demultiplexing", "Dereplication", "Filtering", "Error removal", "Taxonomic assignment"),heights = c(1.4,1,1,1.3,1.1,1.1), font.label = list(size = 10))
plot_time
plot_assign <- ggplot(time_assign, aes(x=reorder(program, time_grinder), y=time_grinder, label=time_grinder)) +
geom_bar(stat = "identity", width=0.35) +
geom_text(size = 4, position = position_nudge(y = +3)) +
xlab("") +
ylab("Time (min)") +
ggtitle("Taxonomic assignment")+
theme(axis.text.x = element_text(size = 9)) +
theme(axis.text.y = element_text(size = 12)) +
theme(panel.background = element_rect(fill="white", colour="grey", size=0.5, linetype="solid"))+
coord_flip()
plot_time <- ggarrange(plot_merging, plot_demul, plot_derep, plot_filter, plot_error, plot_assign, ncol=1, hjust=-0.5, vjust=1.1, labels = c("Merging", "Demultiplexing", "Dereplication", "Filtering", "Error removal", "Taxonomic assignment"),heights = c(1.4,1,1,1.3,1.1,1.1), font.label = list(size = 10))
plot_time
plot_assign
plot_time <- ggarrange(plot_merging, plot_demul, plot_derep, plot_filter, plot_error, plot_assign, ncol=1, hjust=-0.5, vjust=1.1, labels = c("Merging", "Demultiplexing", "Dereplication", "Filtering", "Error removal", "Taxonomic assignment"),heights = c(1.4,1,1,1.3,1.1,1.1), font.label = list(size = 10))
plot_time
plot_merging <- ggplot(time_merging, aes(x=reorder(program, time_grinder), y=time_grinder, label=time_grinder)) +
geom_bar(stat = "identity", width=0.4) +
geom_text(size = 4, position = position_nudge(y = +70)) +
xlab("") +
ylab("") +
ggtitle("Merging")+
theme(axis.text.x = element_text(size = 9)) +
theme(axis.text.y = element_text(size = 12)) +
theme(title = element_text(size=10))+
theme(panel.background = element_rect(fill="white", colour="grey", size=0.5, linetype="solid"))+
coord_flip()
time_demul <- time %>%
filter(step=="demultiplex")
plot_demul <- ggplot(time_demul, aes(x=reorder(program, time_grinder), y=time_grinder, label=time_grinder)) +
geom_bar(stat = "identity", width=0.3) +
geom_text(size = 4, position = position_nudge(y = +30)) +
xlab("") +
ylab("") +
ggtitle("Demultiplexing")+
theme(axis.text.x = element_text(size = 9)) +
theme(axis.text.y = element_text(size = 12)) +
theme(title = element_text(size=10))+
theme(panel.background = element_rect(fill="white", colour="grey", size=0.5, linetype="solid"))+
coord_flip()
time_derep <- time %>%
filter(step=="dereplication")
plot_derep <- ggplot(time_derep, aes(x=reorder(program, time_grinder), y=time_grinder, label=time_grinder)) +
geom_bar(stat = "identity", width=0.3) +
geom_text(size = 4, position = position_nudge(y = +10)) +
xlab("") +
ylab("") +
ggtitle("Dereplication")+
theme(axis.text.x = element_text(size = 9)) +
theme(axis.text.y = element_text(size = 12)) +
theme(title = element_text(size=10))+
theme(panel.background = element_rect(fill="white", colour="grey", size=0.5, linetype="solid"))+
coord_flip()
time_filter <- time %>%
filter(step=="filtering")
plot_filter <- ggplot(time_filter, aes(x=reorder(program, time_grinder), y=time_grinder, label=time_grinder)) +
geom_bar(stat = "identity", width=0.4) +
geom_text(size = 4, position = position_nudge(y = +0.1)) +
xlab("") +
ylab("") +
ggtitle("Filtering")+
theme(axis.text.x = element_text(size = 9)) +
theme(axis.text.y = element_text(size = 12)) +
theme(title = element_text(size=10))+
theme(panel.background = element_rect(fill="white", colour="grey", size=0.5, linetype="solid"))+
coord_flip()
time_error <- time %>%
filter(step=="error_removal")
plot_error <- ggplot(time_error, aes(x=reorder(program, time_grinder), y=time_grinder, label=time_grinder)) +
geom_bar(stat = "identity", width=0.35) +
geom_text(size = 4, position = position_nudge(y = +1)) +
xlab("") +
ylab("") +
ggtitle("Error removal")+
theme(axis.text.x = element_text(size = 9)) +
theme(axis.text.y = element_text(size = 12)) +
theme(title = element_text(size=10))+
theme(panel.background = element_rect(fill="white", colour="grey", size=0.5, linetype="solid"))+
coord_flip()
time_assign <- time %>%
filter(step=="assignment")
plot_assign <- ggplot(time_assign, aes(x=reorder(program, time_grinder), y=time_grinder, label=time_grinder)) +
geom_bar(stat = "identity", width=0.35) +
geom_text(size = 4, position = position_nudge(y = +3)) +
xlab("") +
ylab("Time (min)") +
ggtitle("Taxonomic assignment")+
theme(axis.text.x = element_text(size = 9)) +
theme(axis.text.y = element_text(size = 12)) +
theme(title = element_text(size=10))+
theme(panel.background = element_rect(fill="white", colour="grey", size=0.5, linetype="solid"))+
coord_flip()
plot_time <- ggarrange(plot_merging, plot_demul, plot_derep, plot_filter, plot_error, plot_assign, ncol=1, heights = c(1.4,1,1,1.3,1.1,1.1), font.label = list(size = 10))
plot_time
plot_merging <- ggplot(time_merging, aes(x=reorder(program, time_grinder), y=time_grinder, label=time_grinder)) +
geom_bar(stat = "identity", width=0.4) +
geom_text(size = 4, position = position_nudge(y = +70)) +
xlab("") +
ylab("") +
ggtitle("Merging")+
theme(axis.text.x = element_text(size = 9)) +
theme(axis.text.y = element_text(size = 12)) +
theme(title = element_text(size=9, face = "bold"))+
theme(panel.background = element_rect(fill="white", colour="grey", size=0.5, linetype="solid"))+
coord_flip()
plot_demul <- ggplot(time_demul, aes(x=reorder(program, time_grinder), y=time_grinder, label=time_grinder)) +
geom_bar(stat = "identity", width=0.3) +
geom_text(size = 4, position = position_nudge(y = +30)) +
xlab("") +
ylab("") +
ggtitle("Demultiplexing")+
theme(axis.text.x = element_text(size = 9)) +
theme(axis.text.y = element_text(size = 12)) +
theme(title = element_text(size=9, face = "bold"))+
theme(panel.background = element_rect(fill="white", colour="grey", size=0.5, linetype="solid"))+
coord_flip()
plot_derep <- ggplot(time_derep, aes(x=reorder(program, time_grinder), y=time_grinder, label=time_grinder)) +
geom_bar(stat = "identity", width=0.3) +
geom_text(size = 4, position = position_nudge(y = +10)) +
xlab("") +
ylab("") +
ggtitle("Dereplication")+
theme(axis.text.x = element_text(size = 9)) +
theme(axis.text.y = element_text(size = 12)) +
theme(title = element_text(size=9, face = "bold"))+
theme(panel.background = element_rect(fill="white", colour="grey", size=0.5, linetype="solid"))+
coord_flip()
plot_filter <- ggplot(time_filter, aes(x=reorder(program, time_grinder), y=time_grinder, label=time_grinder)) +
geom_bar(stat = "identity", width=0.4) +
geom_text(size = 4, position = position_nudge(y = +0.1)) +
xlab("") +
ylab("") +
ggtitle("Filtering")+
theme(axis.text.x = element_text(size = 9)) +
theme(axis.text.y = element_text(size = 12)) +
theme(title = element_text(size=9, face = "bold"))+
theme(panel.background = element_rect(fill="white", colour="grey", size=0.5, linetype="solid"))+
coord_flip()
plot_error <- ggplot(time_error, aes(x=reorder(program, time_grinder), y=time_grinder, label=time_grinder)) +
geom_bar(stat = "identity", width=0.35) +
geom_text(size = 4, position = position_nudge(y = +1)) +
xlab("") +
ylab("") +
ggtitle("Error removal")+
theme(axis.text.x = element_text(size = 9)) +
theme(axis.text.y = element_text(size = 12)) +
theme(title = element_text(size=9, face = "bold"))+
theme(panel.background = element_rect(fill="white", colour="grey", size=0.5, linetype="solid"))+
coord_flip()
plot_assign <- ggplot(time_assign, aes(x=reorder(program, time_grinder), y=time_grinder, label=time_grinder)) +
geom_bar(stat = "identity", width=0.35) +
geom_text(size = 4, position = position_nudge(y = +3)) +
xlab("") +
ylab("Time (min)") +
ggtitle("Taxonomic assignment")+
theme(axis.text.x = element_text(size = 9)) +
theme(axis.text.y = element_text(size = 12)) +
theme(title = element_text(size=9, face = "bold"))+
theme(panel.background = element_rect(fill="white", colour="grey", size=0.5, linetype="solid"))+
coord_flip()
plot_time <- ggarrange(plot_merging, plot_demul, plot_derep, plot_filter, plot_error, plot_assign, ncol=1, heights = c(1.4,1,1,1.3,1.1,1.1), font.label = list(size = 10))
plot_time
ggsave("c:/Users/mathon/Desktop/PhD/Projets/Comparaison_pipelines/Articles et rapports/Figures papier/Figure_3.png")
ggsave("c:/Users/mathon/Desktop/PhD/Projets/Comparaison_pipelines/Articles et rapports/Figures papier/Figure_3.png", dpi = 600)
ggsave("c:/Users/mathon/Desktop/PhD/Projets/Comparaison_pipelines/Articles et rapports/Figures papier/Figure_3.pdf")
time <- read.csv("C:/Users/mathon/Desktop/PhD/Projets/Comparaison_pipelines/time_programs.csv", sep = ";")
time_merging <- time %>%
filter(step=="merging")
plot_merging <- ggplot(time_merging, aes(x=reorder(program, time_carry), y=time_carry, label=time_carry)) +
geom_bar(stat = "identity", width=0.4) +
geom_text(size = 4, position = position_nudge(y = +70)) +
xlab("") +
ylab("") +
ggtitle("Merging")+
theme(axis.text.x = element_text(size = 9)) +
theme(axis.text.y = element_text(size = 12)) +
theme(title = element_text(size=9, face = "bold"))+
theme(panel.background = element_rect(fill="white", colour="grey", size=0.5, linetype="solid"))+
coord_flip()
time_demul <- time %>%
filter(step=="demultiplex")
plot_demul <- ggplot(time_demul, aes(x=reorder(program, time_carry), y=time_carry, label=time_carry)) +
geom_bar(stat = "identity", width=0.3) +
geom_text(size = 4, position = position_nudge(y = +15)) +
xlab("") +
ylab("") +
ggtitle("Demultiplexing")+
theme(axis.text.x = element_text(size = 9)) +
theme(axis.text.y = element_text(size = 12)) +
theme(title = element_text(size=9, face = "bold"))+
theme(panel.background = element_rect(fill="white", colour="grey", size=0.5, linetype="solid"))+
coord_flip()
time_derep <- time %>%
filter(step=="dereplication")
plot_derep <- ggplot(time_derep, aes(x=reorder(program, time_carry), y=time_carry, label=time_carry)) +
geom_bar(stat = "identity", width=0.3) +
geom_text(size = 4, position = position_nudge(y = +1)) +
xlab("") +
ylab("") +
ggtitle("Dereplication")+
theme(axis.text.x = element_text(size = 9)) +
theme(axis.text.y = element_text(size = 12)) +
theme(title = element_text(size=9, face = "bold"))+
theme(panel.background = element_rect(fill="white", colour="grey", size=0.5, linetype="solid"))+
coord_flip()
time_filter <- time %>%
filter(step=="filtering")
plot_filter <- ggplot(time_filter, aes(x=reorder(program, time_carry), y=time_carry, label=time_carry)) +
geom_bar(stat = "identity", width=0.4) +
geom_text(size = 4, position = position_nudge(y = +2)) +
xlab("") +
ylab("") +
ggtitle("Filtering")+
theme(axis.text.x = element_text(size = 9)) +
theme(axis.text.y = element_text(size = 12)) +
theme(title = element_text(size=9, face = "bold"))+
theme(panel.background = element_rect(fill="white", colour="grey", size=0.5, linetype="solid"))+
coord_flip()
time_error <- time %>%
filter(step=="error_removal")
plot_error <- ggplot(time_error, aes(x=reorder(program, time_carry), y=time_carry, label=time_carry)) +
geom_bar(stat = "identity", width=0.35) +
geom_text(size = 4, position = position_nudge(y = +1)) +
xlab("") +
ylab("") +
ggtitle("Error removal")+
theme(axis.text.x = element_text(size = 9)) +
theme(axis.text.y = element_text(size = 12)) +
theme(title = element_text(size=9, face = "bold"))+
theme(panel.background = element_rect(fill="white", colour="grey", size=0.5, linetype="solid"))+
coord_flip()
time_assign <- time %>%
filter(step=="assignment")
plot_assign <- ggplot(time_assign, aes(x=reorder(program, time_carry), y=time_carry, label=time_carry)) +
geom_bar(stat = "identity", width=0.35) +
geom_text(size = 4, position = position_nudge(y = +3)) +
xlab("") +
ylab("") +
ggtitle("Taxonomic assignment")+
theme(axis.text.x = element_text(size = 9)) +
theme(axis.text.y = element_text(size = 12)) +
theme(title = element_text(size=9, face = "bold"))+
theme(panel.background = element_rect(fill="white", colour="grey", size=0.5, linetype="solid"))+
coord_flip()
ggarrange(plot_merging, plot_demul, plot_derep, plot_filter, plot_error, plot_assign, ncol=1, heights = c(1.4,1,1,1.3,1.1,1.1), font.label = list(size=10))
plot_assign <- ggplot(time_assign, aes(x=reorder(program, time_carry), y=time_carry, label=time_carry)) +
geom_bar(stat = "identity", width=0.35) +
geom_text(size = 4, position = position_nudge(y = +3)) +
xlab("") +
ylab("Time (min)") +
ggtitle("Taxonomic assignment")+
theme(axis.text.x = element_text(size = 9)) +
theme(axis.text.y = element_text(size = 12)) +
theme(title = element_text(size=9, face = "bold"))+
theme(panel.background = element_rect(fill="white", colour="grey", size=0.5, linetype="solid"))+
coord_flip()
ggarrange(plot_merging, plot_demul, plot_derep, plot_filter, plot_error, plot_assign, ncol=1, heights = c(1.4,1,1,1.3,1.1,1.1), font.label = list(size=10))
ggsave("c:/Users/mathon/Desktop/PhD/Projets/Comparaison_pipelines/Articles et rapports/Figures papier/Figure_S14.pdf")
ggsave("c:/Users/mathon/Desktop/PhD/Projets/Comparaison_pipelines/Articles et rapports/Figures papier/Figure_S14.png")
